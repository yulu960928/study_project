<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <!-- App log -->
    <springProperty scope="context" name="BASE_PACKAGE" source="log.app.basePackage" defaultValue="com.stat.demo"/>
    <springProperty scope="context" name="APP_LOG_PATH" source="log.app.path" defaultValue="/applog"/>
    <springProperty scope="context" name="APP_LOG_NAME" source="spring.application.name" defaultValue="application"/>
    <springProperty scope="context" name="APP_MAX_HISTORY" source="log.app.roll.time.maxHistory" defaultValue="48"/>
    <springProperty scope="context" name="APP_MAX_FILE_SIZE" source="log.app.roll.size.maxSize" defaultValue="300MB"/>

    <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
        <encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
            <!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度,%msg：日志消息，%n是换行符-->
            <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} $$$$[%thread]$$$$ %-5level $$$$%logger{50} - $$$$%msg%n</pattern>
        </encoder>
    </appender>
    <!--文件日志， 按照每天生成日志文件 -->
    <appender name="FILE" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <rollingPolicy class="ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy">
            <!--日志文件输出的文件名-->
            <FileNamePattern>${APP_LOG_PATH}/${APP_LOG_NAME}/${APP_LOG_NAME}-app.log.%d{yyyy-MM-dd-HH}.%i.log
            </FileNamePattern>
            <!--日志文件保留天数-->
            <MaxHistory>${APP_MAX_HISTORY}</MaxHistory>
            <maxFileSize>${APP_MAX_FILE_SIZE}</maxFileSize>
            <totalSizeCap>1GB</totalSizeCap>
        </rollingPolicy>
        <encoder class="ch.qos.logback.classic.encoder.PatternLayoutEncoder">
            <!--格式化输出：%d表示日期，%thread表示线程名，%-5level：级别从左显示5个字符宽度%msg：日志消息，%n是换行符-->
            <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} $$$$[%thread] $$$$%-5level $$$$%logger{50} - $$$$%msg%n</pattern>
        </encoder>
    </appender>

    <!--    <logger name="${BASE_PACKAGE}" level="info" additivity="false">-->
    <!--        <appender-ref ref="STDOUT" />-->
    <!--        <appender-ref ref="FILE" />-->
    <!--    </logger>-->

    <logger name="org.apache.zookeeper.ClientCnxn">
        <level value="info"></level>
        <appender-ref ref="STDOUT"/>
        <appender-ref ref="FILE"/>
    </logger>

    <!-- show parameters for hibernate sql 专为 Hibernate 定制 -->
    <logger name="org.hibernate.type.descriptor.sql.BasicBinder" level="TRACE"/>
    <logger name="org.hibernate.type.descriptor.sql.BasicExtractor" level="DEBUG"/>
    <logger name="org.hibernate.SQL" level="DEBUG"/>
    <logger name="org.hibernate.engine.QueryParameters" level="DEBUG"/>
    <logger name="org.hibernate.engine.query.HQLQueryPlan" level="DEBUG"/>

    <!--myibatis log configure-->
    <logger name="com.apache.ibatis" level="TRACE"/>
    <logger name="java.sql.Connection" level="DEBUG"/>
    <logger name="java.sql.Statement" level="DEBUG"/>
    <logger name="java.sql.PreparedStatement" level="DEBUG"/>

    <logger name="org.apache.zookeeper.ClientCnxn" level="INFO"/>

    <springProfile name="dev">
        <root level="info">
            <appender-ref ref="FILE"/>
            <appender-ref ref="STDOUT"/>
        </root>
    </springProfile>

    <springProfile name="test">
        <root level="info">
            <appender-ref ref="FILE"/>
            <appender-ref ref="STDOUT"/>
        </root>
    </springProfile>

    <springProfile name="stg">
        <root level="warn">
            <appender-ref ref="FILE"/>
            <appender-ref ref="STDOUT"/>
        </root>
    </springProfile>

    <springProfile name="prod">
        <root level="warn">
            <appender-ref ref="FILE"/>
        </root>
    </springProfile>

</configuration>